foreign [Music] okay so we are talking about the problems with gradient descent and as you go along in this lecture we'll try to fix some of those problems but for that discussion it would be useful to understand how to draw contour maps because that would just make our life easier in terms of drawing the plots and so on and also Contours as an or contour maps is an important concept to know if you're doing machine learning deep learning and so on right so the idea here is this side that visualizing things in 3D can sometimes become a bit cumbersome right and so uh at least if images are static then you can only view it from a certain angle and so on so can we just do a 2d visualization of this traversal along the error surface and so to do that we need to know what are Contours so let's look at this right so now again we'll start with the 3D plot right so this is like a complex 3D plot that we have here okay and now I'll start with this question right that uh if I were to take or let me just draw the contour map and then try to comment this question right so now what I'm going to do is I'm going to draw something which is called as a contour map corresponding to this 3D plot without telling you what a contour map is right so I'll just go ahead and draw it and then I'll come back and explain what a contour map is right so you can see what I've done here right so let me just point out a few things that have been done here so what I've done is whatever surface was given to me at regular intervals along the z-axis so let me just straighten this so that the z-axis is vertical okay whatever reasons okay this is good yeah maybe this angle is good so at regular intervals along the Z axis I have taken slices right so these are the slices that I have taken at regular intervals along the z-axis and I've also labeled the intervals right so this is minus 0.8 this is the slice at minus 0.6 minus 0.4 minus 0.2 and this is at -1 right so these are regular intervals because they are happening at intervals of 0.2 and similarly I keep doing so at every point two distance I have taken a slice now if I were to see this from the top okay and maybe I should delete yeah so if I were to um yeah so I've done these slices at regular intervals and I've also labeled the slices now if I were to look at it from the top this is what it would look like right and this is exactly what the contour map looks like which is drawn on the right hand side right so contour map is like the top view of a 3D plot such that you take slices at regular intervals and then imagine what the slices would look from the top and that's what you draw here right so at any level here right so any of these circles or any of the Rings that you see here they're not all perfect circles but I can call them Rings any of the Rings that you see on this side note that for across that ring the value of the z-axis is the same right because that's how I've taken I have taken a slice which is parallel to the X Y axis so it's at a particular level on the Z axis so this ring for example corresponds to the level one right so this link here is level one ring this ring here is level 0.8 ring point six point four point two and so on right so that's how uh this has been uh drawn it's every ring corresponds to one value along the Z axis in our case or the X Y axis would be like the w b axis and the Z axis would be the loss axis so every slice here would correspond to the same value of the loss function because R cross along the ring the value of the loss function is there because we have taken a slice along the vertical axis right so you have a parallel plane so the loss would be the same across that axis right and when you look at it from the top uh this is how it looks like and that's exactly what the contour map looks like now there are certain other interesting things to be said about the contour map right and let me just get a hang of this I want to put certain view from which the point that I want to explain becomes easy okay this is the view that I want now what you see here right uh on this plot here is that in some cases the distance between the Rings is large right not just that the distance between the Rings is large here but it's very small here right so I'm talking about the same two rings right so let me just highlight those two rings so I'm talking about this ring and this ring okay I'm not circling the full thing because it will just become a bit untidy so if I look here the distance between the two rings is large but the distance between the same two rings here is a bit small right it's quite smaller than what it is here so why is that happening right and you can see that it's relates to the idea of slope and that's why I wanted this other view here so if you look at this right here here the slope is very Steep and here the slope is gentle right so now if I look at the distance between these two rings horrible so if I look at the distance between these two rings right so let me just delete things yeah now what I was saying is that if I look at the difference between distance between these two rings okay and now imagine I am looking for the top then here the slope is gentle whereas here the slope is steep so wherever the slope is gentle the distance between the two rings would be large whereas whether the slope is steep the distance between the two rings would be small right so this the idea of steep and gentle slope was very important for uh the discussion that we were doing right we needed to know in which regions was the slope Steep and in which regions was the gentle and now the contour maps actually capture that information right so you just need to look at the contour map and if I see that here the distance is large that means the slope would have been gentle here the distance is small that means in that region the slope would have been very steep right so looking at the contour map because the level information is also there I can actually guess what the 3D surface looks like and there will be a contour map corresponding to every 3D surface right so let us look at one more 3D surface the main takeaways here are this that these Rings correspond to levels on the loss axis and they are equidistant right that means they have been taken at equal distances on the loss axis the other is the distance between the Rings tells us about the slope in that direction if the distance is large then the slope was gentle and I gave you explain it with the help of this example I have this slope was steep then the distance was small as we saw here right so that's what the contour maps capture so in short they capture all the information that we are interested in when we are talking about gradient descent based algorithms right so let me just look at one more example right let me take a different function now suppose I take this function okay this is what this function looks like right now let me try to guess what the contour map would look like right uh or other let me just draw the contour map right this is what the contour map looks like and here again you can see that here yeah here the distance is large and does it correspond to my intuition that the slope would be large in that region so let's see that right indeed the slope was sorry the slope would be uh gentle in that region right so whenever the slope is gentle the distance between the Rings is large and whenever the slope is steep for example here it's very steep right so in this region as you can see this if I look at the plot on the left hand side these here the slope is very uh yeah here the slope is very steep so the distance between the Rings is small here the slope is gentle so the distance between the Rings is large right so that's that's the idea captured in a contour map you could take there are many functions given here so I would encourage you to kind of go back and try out different functions right so this is yet another function I think quite uh complex and we can try to draw the contour map for that it looks quite horrible right but you could just relate it to the intuition that we had right and maybe inverse functions are a bit uh perhaps I should stay away from that right but this function now now if I try to draw the contour map for this function it again matches the intuition that we had that in the regions where the slope is uh yeah this is what the function looks like so here the slope is throughout very steep right so the distance between the Rings is smaller here okay so we'll come back to the original function that we had yeah and I'll draw the Contour plot here and this is what it looks like right so I think if you play around with this function you will get a lot of insights into what the Contours Maps capture and the main intuition is about the slopes and the distance between the Rings right so now that we understand what contour maps are right let's try to do this we will revisit uh the gradient descent algorithm and now try to explain in terms of the movement on the contour map right so this was my uh 3D plot and what you see here and here is the corresponding contour map right and you can see that in this region which corresponds to this region here the slope is very gentle hence the distance between this contour line and the next contour line which is not even visible is very large right and here right as I am going into the valley as I'm going into the valley you can see that all the contour lines are very close to each other because the slope is very steep there again here as you can see the here the slope is gentle so the distance between the contour lines is high but as I keep coming down the slope becomes sharp and my distance between the contour lines decreases right and same thing you can see everywhere right wherever the slope is sharp you will see that the distance between the contour lines is smaller now this entire gradient descent algorithm now I could just visualize it on the contour map itself right and here you have both in Parable so these are the two views that we have the 3D surface and its contour map at the bottom then the contour map and what happens actually to the sigmoid function right so let's try to look at both this views and get comfortable with them right so just as the point was moving on the 3D loss surface you can also show the point moving on the 2D surface so now I just have the WB plane and I can now I can see how the loss function is imposed on the WB plane right because I can draw the contour map and the contour map gives me all the information right it tells me what the loss levels are right it tells me what the loss levels are I can see all the loss levels here and also by looking at the difference between the loss levels I'll know what the slope looks like and now here again I see that in this region here right where the slope was sharp there is a sharp movement there is a rapid movement which happens let's play it again so now the slope is gentle so it's moving very small slowly on the 2D contour map here and then it as it moves towards the steep region now it will speed up and then again it enters the shallow or the gentle slope region and then again it will move slowly right and now I can just get rid of this 3D view I'll just work with the 2D view where I have the contour map I know what the loss is that the loss is high so this is color coded so whether for dark red means High loss functions the dark blue means loss low loss regions and there's a gradation from dark red to dark blue red so pink would mean somewhere in between and this is what the pink here is right and now it's moving on this 2D plot and I can see what is happening so now I have reached close to conversion so my points are almost on the sigmoid function and earlier I was moving very very slowly when I was at this point right and now as I am going to enter the value you will see a sudden change in my w and B a very large change in my wnb and the entire shape of my sigmoid function will change right and now I have entered the value I'm close to convergence and slowly slowly moving so that these two points become completely on the sigmoid curve they are not completely on the curve yet slightly off but it will slowly move towards that conversion okay so now we know how to see a 3D plot and imagine what its contour map would look like or the other way around that look at a contour map and understand what the 3D plot could have looked like right because we know that these were the regions of gentle slope the and the lost levels are marked I have not marked the actual levels but I've just color coded them so wherever you see dark red you know it's bad and whenever you see dark blue you know it's good okay fine so we'll end this module here so we know about Contours now and now we'll uh try to go back to our discussion on gradient descent and see whether we can fix the problem that we had discussed okay